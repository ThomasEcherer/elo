Ext.data.JsonP.core_04_communication({"guide":"<h1 id='core_04_communication-section-communication-between-web-page-and-client'>Communication between web page and client</h1>\n<div class='toc'>\n<p><strong>Contents</strong></p>\n<ul>\n<li>1. <a href='#!/guide/core_04_communication-section-prerequisites'>Prerequisites</a>\n </li>\n<li>2. <a href='#!/guide/core_04_communication-section-web-page-side'>Web Page side</a>\n </li>\n<li>3. <a href='#!/guide/core_04_communication-section-client-side-%28web-client%29'>Client side (Web Client)</a>\n </li>\n<li>4. <a href='#!/guide/core_04_communication-section-client-side-%28java-client%29'>Client side (Java Client)</a>\n </li>\n</ul></div>\n\n<p>Since ELO 9.02 it is possible for the ELO web pages (like workflow forms, feed,\nmy elo etc.) to communicate messages and events to the client and vice versa.\nThis guide will show how this feature can be used inside custom scripting.</p>\n\n<h2 id='core_04_communication-section-prerequisites'>Prerequisites</h2>\n\n<p>To communicate between client and web page, both must have an implementation of\nthe communication api available.\nThese are the client currectly supporting the communication library:</p>\n\n<ul>\n<li>ELO Java Client (since 9.02.008)</li>\n<li>ELO Web Client (since 9.02.000 build 234)</li>\n</ul>\n\n\n<p>These are the web pages loading the communication library:</p>\n\n<ul>\n<li>ELO forms</li>\n<li>Document feeds</li>\n<li>My ELO/ Feed Aggregation</li>\n<li>ELO Apps</li>\n</ul>\n\n\n<p>To use communication there must be a scripting possibility on both sides.\nFor the web pages this is only available in the ELO forms and ELO apps.</p>\n\n<p>To send message between both parties, the web page must be rendered and loaded.</p>\n\n<h2 id='core_04_communication-section-web-page-side'>Web Page side</h2>\n\n<p>The web page is embedded inside the client. To communicate to the client (parent)\nthe singleton api.communication.Parent ist used.</p>\n\n<p>To check if a client is wrapping the page you can use:</p>\n\n<pre><code>api.communication.Parent.hasParent();\n</code></pre>\n\n<p>To send a custom script message to the client:</p>\n\n<pre><code>api.communication.Parent.sendCustomMessage('FOO', {my: 'data'}, function(data, event){\n    // Handle responses from the client to this 'FOO' message.\n    // There is no response of a response\n});\n</code></pre>\n\n<p>Here the first parameter ('FOO') can be any String. On the client side you can register\na handler to listen to messages with the same string name. The second parameter\nis any JavaScript Object that should be communicated to the client. This is done via JSON serialization.\nThe third parameter is a callback function to handle any response a client sends to this message.\nInside the reponse function you cannot re-response again, but sent a new message via sendCustomMessage.\nIt lies in the responsibility of the client to sent back a response. If it doesn't the function will never get called.</p>\n\n<p>To listen to a custom event from the client:</p>\n\n<pre><code>api.communication.Parent.onCustomMessage('BAR', function(data, event){\n    // handle 'BAR' messages from the client.\n\n    // maybe send a response back\n    api.communication.Parent.sendResponse(event, { /* some response data */ });\n});\n</code></pre>\n\n<p>Here a listener is registered to handle all 'BAR' messages from a client. If\nthis client wants to send a response e can use the sendResponse function. The first\nparameter of the response function is always the original incoming event from the client.\nThe second parameter is a object holding the reponse data. The library needs the\noriginal event object to respond back to the correct message.</p>\n\n<h2 id='core_04_communication-section-client-side-%28web-client%29'>Client side (Web Client)</h2>\n\n<p>To handle incoming messages from the web page:</p>\n\n<pre><code>api.EventManager.addComponentListener('CMP_IFRAME', 'FOO', function(scope, state){\n    // Handle the FOO message sent from the web page\n    // Maybe send a response back to the page.\n    scope.sendResponse(state.get('event'), {/* response data */});\n});\n</code></pre>\n\n<p>Here the String 'CMP_IFRAME' is a constant of the Web Client to register the\nlistener function to any custom 'FOO' events that are received in any iframe.\nThe listener function gets called with two parameters. The scope is the wrapper\nobject needed to send responses. The state is the normal Web Client state object.\nIt contains a members 'message' (the msgdata sent), 'event' (the complete event\nobject needed to answer to it) and 'scope' (the wrapper again).</p>\n\n<p>To sent a message from the Web Client to a ELO form page:</p>\n\n<pre><code>var child = api.Webclient.getActiveIFrameInterface('ELOWF_FORMULAR');\nif (child){\n    child.sendCustomMessage('BAR', { \n        msg: 'Hello World from the Web Client.' \n    });\n}\n</code></pre>\n\n<p>Here the String 'ELOWF_FORMULAR' is a constant of the Web Client to retrieve\n a wrapper object of the currently rendered formular iframe. To this iframe\nthe 'BAR' is sent.</p>\n\n<p>Also see the script custom-communication.js in the /dev folder of any 9.02\nWeb Client installation.</p>\n\n<h2 id='core_04_communication-section-client-side-%28java-client%29'>Client side (Java Client)</h2>\n\n<p>To handle incoming messages from the a web page the following function must be implemented in a script:</p>\n\n<pre><code>function eloReceiveBrowserMessage(msg, compName){\n    // Handle the message sent from the web page given by compName\n\n\n    // Maybe send a response back to the page.\n    var browserComp = components.getClientBrowserComponent(compName);\n    browserComp.sendCustomResponse(msg, {/* response data */});\n}\n</code></pre>\n\n<p>Here the message is the complete message object. And compName is the name of the\n browser component the message was sent from. In order to listen to a specific\nmessage name, the implementation must check if e.g. msg.name is 'FOO'.</p>\n\n<p>To sent a message from the Java Client to a ELO form page:</p>\n\n<pre><code>var browserComp = components.getClientBrowserComponent(CONSTANTS.BROWSER_COMPONENT_NAME.FORMULAR_PANEL);\nvar fctParamsObject = { \n        msg: 'Hello World from the Java Client.' \n    };\nbrowserComp.callCustomFunction( \"BAR\", fctParamsObject, \"responseFunction\" );\n</code></pre>\n\n<p>Here the browser component is identified by the CONSTANTS.BROWSER_COMPONENT_NAME\nobject. To this component the 'BAR' message is sent. The last parameter is the\n name of a function that should be called in case of a response.</p>\n\n<pre><code>function responseFunction(data, event){\n    // hanlde the response to the prior message\n}\n</code></pre>\n","title":"Communication"});