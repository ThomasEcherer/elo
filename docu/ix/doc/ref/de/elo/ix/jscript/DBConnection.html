<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (1.8.0_92) on Wed Apr 04 13:01:29 CEST 2018 -->
<title>DBConnection (ELO IndexServer Documentation)</title>
<meta name="date" content="2018-04-04">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DBConnection (ELO IndexServer Documentation)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../de/elo/ix/jscript/Convert.html" title="class in de.elo.ix.jscript"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../de/elo/ix/jscript/DBConnection.PreparedStatementWrapper.html" title="class in de.elo.ix.jscript"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?de/elo/ix/jscript/DBConnection.html" target="_top">Frames</a></li>
<li><a href="DBConnection.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">de.elo.ix.jscript</div>
<h2 title="Class DBConnection" class="title">Class DBConnection</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>de.elo.ix.jscript.DBConnection</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">DBConnection</span>
extends java.lang.Object</pre>
<div class="block">This class provides access to an external database.
 <p>
 In order to use this class to access external databases, a connection pool has to be defined 
 as a JNDI Resource e.g. in the
 Tomcat configuration file Tomcat/conf/context.xml.
 </p>
 <p>
 It is also possible to access the ELO archive database the IndexServer is connected to. 
 The default constructor of <code>DBConnection</code> obtains a connection for this purpose.   
 </p>
 <h1>Configure Database Pool</h1>
 <p>
 The following XML code shows examples for resource definitions for ORALCE, DB2 and Microsoft SQL
 Server.
 </p>
 
 <pre>
 <code class="example">
 
   &lt;Resource name="jdbc/MyORACLE" auth="Container"
               type="javax.sql.DataSource" driverClassName="oracle.jdbc.OracleDriver"
               url="jdbc:oracle:thin:@srvporacle01vm:1521:ora11uni"
               username="elo80_ora" password="elodb" maxActive="20" maxIdle="10"
               maxWait="-1" /&gt; 
               
   &lt;Resource name="jdbc/MyDB2" auth="Container"
               type="javax.sql.DataSource" driverClassName="com.ibm.db2.jcc.DB2Driver"
               url="jdbc:db2://srvt02:50000/elotestu"
               username="elodb" password="elodb" maxActive="20" maxIdle="10"
               maxWait="-1"/&gt;
               
   &lt;Resource name="jdbc/MyMSSQL" auth="Container"
               type="javax.sql.DataSource" driverClassName="com.microsoft.sqlserver.jdbc.SQLServerDriver"
               url="jdbc:sqlserver://localhost:1433;databaseName=elo80"
               username="elodb" password="elodb" maxActive="20" maxIdle="10"
               maxWait="-1"/&gt;
  
  </code>
 </pre>
 <p>
 <ul>
 <i> Hints:
 <li>DB2 does not provide an argument for the schema name in the jdbc-url string. The schema has
 to be supplied in the constructor of the DBConnection class.</li>
 <li>The database name for a Microsoft SQL Server connection can either be defined in the JNDI
 Resource by the argument "databaseName" in the jdbc-url. Or it can be supplied in the constructor
 of the DBConnection class.</li> </i>
 </ul>
 </p>
 <p>
 For more information on how to configure database connection pools, refer to the original Tomcat
 documentation resp. the documentation of the application server that is used.
 </p>
 <h1>Execute SELECT Statement</h1>
 <p>
 The following JavaScript function shows how to execute a SELECT command. It creates a new
 DBConnection object that uses database connections from the database pool defined in the JNDI
 Resource "jdbc/MyDB2". The constructor itself does not request a connection. This is done inside
 the query function. When the query function exits, it releases the connection. Thus, there is no
 need to explicitly close a database connection here. Refer to the documentation of the function
 <a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-"><code>query(String, Object, int, Object)</code></a> for more information on executing SELECT commands.
 
 <pre>
 <code class="example">
  function dbread() {
    var db = new Packages.de.elo.ix.jscript.DBConnection( "jdbc/MyDB2", "TESTSCHEMA" );
    var args = ["Stuttgart", 59];
    var ret = db.query("select name, salary from employees where branch like ? and age &gt; ? order by salary", args);
    for (var i = 0; i < ret.length; i++) {
      log.info("name=" + ret[i][0] + ", salary=" + ret[i][1]);
    }
    return ret;
  }
  </code>
 </pre>
 
 </p>
 <h1>Execute INSERT Statement</h1>
 <p>
 The next example inserts two rows into a database table. It uses the update function which can
 also execute UPDATE and DELETE commands. The row data is supplied in an array of rows whereby
 each row is an array of columns. The function returns the number of inserted (updated or deleted)
 database rows.
 
 <pre>
 <code class="example">
  function dbinsert() {
    var db = new Packages.de.elo.ix.jscript.DBConnection( "jdbc/MyDB2", "TESTSCHEMA" );
    var args = [["Fritz", 54321.22, 38],["Maria", 65432.11, 43]];
    var ret = db.update("insert into employees (name, salary, age) values (?, ?, ?)", args);
    log.info("number of inserted rows=" + ret); // == 2
    return ret;
 }
  </code>
 </pre>
 
 </p>
 <h1>Write JDBC Code</h1>
 <p>
 If the query and update functions of this class does not fit the requirements, a JDBC connection
 object can be obtained from a call to the open function. The programmer is responsible for
 releasing this connection by a call to its close method.
 
 <pre>
 <code class="example">
  function dbjdbc() {
    var ret = [];
    var jdbc;
    var stmt;
    var rs;
    try {
       var db = new Packages.de.elo.ix.jscript.DBConnection( );
       jdbc = db.open();
       stmt = jdbc.createStatement();
       rs = stmt.executeQuery("select ....");
       var cols = rs.getMetaData().getColumnCount();
       while (rs.next()) {
         var row = [];
         for (var i = 1; i <= cols; i++) {
           row.push( rs.getString(i) );
         }
         ret.push(row);
       }
     }
    }
    catch (ex) {
      log.error(ex);
    }   
    finally {
      if (rs) try {rs.close();} catch (ignored) {}
      if (stmt) try {stmt.close();} catch (ignored) {}
      if (jdbc) try {jdbc.close();} catch (ignored) {}
    }
    return ret;
 }
  </code>
 </pre>
 
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.PreparedStatementWrapper.html" title="class in de.elo.ix.jscript">DBConnection.PreparedStatementWrapper</a></span></code>
<div class="block">Wrapper class for the JDBC PreparedStatement.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.ResultSetWrapper.html" title="class in de.elo.ix.jscript">DBConnection.ResultSetWrapper</a></span></code>
<div class="block">Wrapper class for the JDBC ResultSet.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#DBConnection--">DBConnection</a></span>()</code>
<div class="block">Constructor.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#DBConnection-java.lang.String-">DBConnection</a></span>(java.lang.String&nbsp;dataSourceName)</code>
<div class="block">Constructor.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#DBConnection-java.lang.String-java.lang.String-">DBConnection</a></span>(java.lang.String&nbsp;dataSourceName,
            java.lang.String&nbsp;schemaName)</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#escapeString-java.lang.String-">escapeString</a></span>(java.lang.String&nbsp;value)</code>
<div class="block">Return an escaped String value to be used in a SQL statement.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#getDatabaseProductName--">getDatabaseProductName</a></span>()</code>
<div class="block">Returns the name of the Database product.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#isDB2--">isDB2</a></span>()</code>
<div class="block">Returns true, if connected to DB2.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#isMssql--">isMssql</a></span>()</code>
<div class="block">Returns true, if connected to Mssql.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#isOracle--">isOracle</a></span>()</code>
<div class="block">Returns true, if connected to Oracle.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#isPgsql--">isPgsql</a></span>()</code>
<div class="block">Returns true, if connected to Mssql.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.sql.Connection</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#open--">open</a></span>()</code>
<div class="block">Open a database connection.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.lang.Object[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-">query</a></span>(java.lang.String&nbsp;sqlcmd)</code>
<div class="block">Execute a SELECT command.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>java.lang.Object[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-">query</a></span>(java.lang.String&nbsp;sqlcmd,
     java.lang.Object&nbsp;params)</code>
<div class="block">Execute a SELECT command.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>java.lang.Object[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-">query</a></span>(java.lang.String&nbsp;sqlcmd,
     java.lang.Object&nbsp;params,
     int&nbsp;max,
     java.lang.Object&nbsp;binding)</code>
<div class="block">Execute a SELECT command.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>java.lang.Integer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#update-java.lang.String-">update</a></span>(java.lang.String&nbsp;sqlcmd)</code>
<div class="block">Executes an update, delete or insert command.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>java.lang.Integer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#update-java.lang.String-java.lang.Object-">update</a></span>(java.lang.String&nbsp;sqlcmd,
      java.lang.Object&nbsp;rows)</code>
<div class="block">Executes an update, delete or insert command.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>java.lang.Integer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../de/elo/ix/jscript/DBConnection.html#update-java.lang.String-java.lang.Object-java.lang.Object-">update</a></span>(java.lang.String&nbsp;sqlcmd,
      java.lang.Object&nbsp;rows,
      java.lang.Object&nbsp;binding)</code>
<div class="block">Executes an update, delete oder insert Statement.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="DBConnection--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DBConnection</h4>
<pre>public&nbsp;DBConnection()
             throws de.elo.ix.exec.IXException</pre>
<div class="block">Constructor.
 Use this constructor to obtain connections from the internal IndexServer connection pool.
 This connections access the ELO archive database.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>de.elo.ix.exec.IXException</code></dd>
</dl>
</li>
</ul>
<a name="DBConnection-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DBConnection</h4>
<pre>public&nbsp;DBConnection(java.lang.String&nbsp;dataSourceName)
             throws javax.naming.NamingException</pre>
<div class="block">Constructor. 
 Calls open with the given parameters</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataSourceName</code> - Data source name specified in the Tomcat configuration. E.g. "jdbc/MyDB2".</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
</dl>
</li>
</ul>
<a name="DBConnection-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DBConnection</h4>
<pre>public&nbsp;DBConnection(java.lang.String&nbsp;dataSourceName,
                    java.lang.String&nbsp;schemaName)
             throws javax.naming.NamingException</pre>
<div class="block">Constructor. 
 Calls open with the given parameters</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataSourceName</code> - Data source name specified in the Tomcat configuration. E.g. "jdbc/MyDB2".</dd>
<dd><code>schemaName</code> - Optional. DB2 schema name or MSSQL database name.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getDatabaseProductName--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDatabaseProductName</h4>
<pre>public&nbsp;java.lang.String&nbsp;getDatabaseProductName()
                                        throws java.sql.SQLException</pre>
<div class="block">Returns the name of the Database product.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="isOracle--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isOracle</h4>
<pre>public&nbsp;boolean&nbsp;isOracle()
                 throws java.sql.SQLException</pre>
<div class="block">Returns true, if connected to Oracle.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
<dd><code>javax.naming.NamingException</code></dd>
</dl>
</li>
</ul>
<a name="isDB2--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDB2</h4>
<pre>public&nbsp;boolean&nbsp;isDB2()
              throws java.sql.SQLException</pre>
<div class="block">Returns true, if connected to DB2.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="isMssql--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isMssql</h4>
<pre>public&nbsp;boolean&nbsp;isMssql()
                throws java.sql.SQLException</pre>
<div class="block">Returns true, if connected to Mssql.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="isPgsql--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isPgsql</h4>
<pre>public&nbsp;boolean&nbsp;isPgsql()
                throws java.sql.SQLException</pre>
<div class="block">Returns true, if connected to Mssql.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="open--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>open</h4>
<pre>public&nbsp;java.sql.Connection&nbsp;open()
                         throws java.sql.SQLException</pre>
<div class="block">Open a database connection. 
 The returned database connections must be closed with a call to its close function.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Connection object</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="query-java.lang.String-java.lang.Object-int-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>query</h4>
<pre>public&nbsp;java.lang.Object[]&nbsp;query(java.lang.String&nbsp;sqlcmd,
                                java.lang.Object&nbsp;params,
                                int&nbsp;max,
                                java.lang.Object&nbsp;binding)
                         throws java.sql.SQLException</pre>
<div class="block">Execute a SELECT command.
 <p>
 This function executes a SQL SELECT command and returns an array of result rows, whereby each
 row is an array of Java objects.
 </p>
 <p>
 Three kinds of query strings in the parameter <code>sqlcmd</code> are supported:
 <ul>
 <li>Simple query without placeholders: <br/>
 Example: <br/>
 <code class="example">db.query("select objid from objekte where objshort like 'it''s my string'", undefined, 0, undefined); </code>
 <br/>
 This will execute the query "select objid from objekte where objshort like 'it''s my string'".<br/>
 </li>
 <li>Query with MessageFormat placeholders:<br/>
 The placeholders are substituted by a java.text.MessageFormat object.<br/>
 Example:<br/>
 <code class="example">db.query("select {1} from {0} where {2} like {3}", ["objekte", "objid", "objshort", "'it''s my string'"], 0, undefined);</code>
 <br/>
 This will execute the query "select objid from objekte where objshort like 'it''s my string'".<br/>
 <i>Hints:Placeholders inside apostrophes - like in "... where objshort like '{0}' ..." - are
 NOT substituted.</i></li>
 <li>Query with PreparedStatement placeholders:<br/>
 The placeholders are substituted by the JDBC driver.<br/>
 Example:<br/>
 <code class="example">db.query("select objid from objekte where objshort like ?", ["it's my string"], 0, undefined);</code>
 <br/>
 <i>Hint: Strings need not to be escaped.</i></li>
 </ul>
 </p>
 <p>
 Databases provide column data for some column types in a non-serializable Java class. E.g. the
 ORACLE database return both integers and doubles as Java BigDecimal objects. Thus it is not
 possible to distinguish between the types and automatically convert to Integer or Double
 without knowlege about the underlying column type definition. To handle this circumstance, a
 JavaScript object can be supplied in the parameter <code>binding</code> that invokes the getter
 functions of the ResultSet object. It has to define a <code>getResult</code> function as shown
 in the example below. The first parameter of the <code>getResult</code> function is a
 <a href="../../../../de/elo/ix/jscript/DBConnection.ResultSetWrapper.html" title="class in de.elo.ix.jscript"><code>DBConnection.ResultSetWrapper</code></a>
 </p>
 <p>
 The following JavaScript class is an example for the <code>binding</code> parameter.
 
 <pre>
 <code class="example">
 function Binding() { 
   this.getResult = function(row, column) {
     // column starts with 1 !
     switch (column) {
       case 1: return row.getString(column);
       case 2: return row.getInteger(column);
       case 3: return row.getBytes(column);
       default: throw "Invalid column";
     }
   };
 }
 
  function dbread() {
    var db = new Packages.de.elo.ix.jscript.DBConnection( "jdbc/MyDB2", "TESTSCHEMA" );
    var args = ["Stuttgart", 59];
    var ret = db.query("select name, age, passportphoto from employees where branch like ? and age &gt; ?", args, 0, new Binding());
    for (var i = 0; i < ret.length; i++) {
      log.info("name=" + ret[i][0] + ", age=" + ret[i][1] + ", photo.length=" + ret[i][2].length);
    }
    return ret;
  }
 </code>
 </pre>
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SELECT command string.</dd>
<dd><code>params</code> - Optional. This parameters are bound if sqlcmd contains placeholders.</dd>
<dd><code>max</code> - Optional. Maximum number of rows to be read. If 0, all selected rows are read.</dd>
<dd><code>binding</code> - Optional. This parameter can hold a JavaScript object that extracts the data of
          a selected column from the ResultSet object.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Java Object[] of rows. If more than one column is selected, each row element is an array of columns.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
<dd><code>javax.naming.NamingException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../de/elo/ix/jscript/DBConnection.ResultSetWrapper.html" title="class in de.elo.ix.jscript"><code>DBConnection.ResultSetWrapper</code></a></dd>
</dl>
</li>
</ul>
<a name="query-java.lang.String-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>query</h4>
<pre>public&nbsp;java.lang.Object[]&nbsp;query(java.lang.String&nbsp;sqlcmd,
                                java.lang.Object&nbsp;params)
                         throws java.sql.SQLException</pre>
<div class="block">Execute a SELECT command.
 This function calls <a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-"><code>query(String, Object, int, Object)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SELECT command.</dd>
<dd><code>params</code> - Optional. This parameters are bound if sqlcmd contains placeholders.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Matrix of rows and columns.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>SQLExcetpion</code></dd>
<dd><code>java.sql.SQLException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-"><code>query(String, Object, int, Object)</code></a></dd>
</dl>
</li>
</ul>
<a name="query-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>query</h4>
<pre>public&nbsp;java.lang.Object[]&nbsp;query(java.lang.String&nbsp;sqlcmd)
                         throws java.sql.SQLException</pre>
<div class="block">Execute a SELECT command.
 This function calls <a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-"><code>query(String, Object, int, Object)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SELECT command.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Matrix of rows and columns.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>SQLExcetpion</code></dd>
<dd><code>java.sql.SQLException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-"><code>query(String, Object, int, Object)</code></a></dd>
</dl>
</li>
</ul>
<a name="update-java.lang.String-java.lang.Object-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre>public&nbsp;java.lang.Integer&nbsp;update(java.lang.String&nbsp;sqlcmd,
                                java.lang.Object&nbsp;rows,
                                java.lang.Object&nbsp;binding)
                         throws java.sql.SQLException</pre>
<div class="block">Executes an update, delete oder insert Statement.
 <p>
 <ul>
 <li>If the SQL command does not contain placeholders, the rows argument must be null.</li>
 <li>If the SQL command contains MessageFormat placeholders like {0}, {1} etc. or the
 PreparedStatement placeholder ?, the rows parameter must not be null.</li>
 <li>If rows is a single Object or an array of Objects, this objects replace the placeholders
 and one database row is updated.</li>
 <li>If rows is an 2-dimensional array of Objects with the dimensions
 <code>rows[rowcount][colcount]</code>, the SQL command contains <code>colcount</code>
 placeholders and <code>rowcount</code> database rows are updated.</li>
 </ul>
 </p>
 <p>
 If the SQL command contains PreparedStatement placeholders, the function parameter <code>binding</code>
 can be supplied. A JavaScript object has to be passed that calls the setters of the internally used 
 JDBC PreparedStatement object. This allows the programmer e.g. to store binary data. The
 <code>binding</code> object has to be defined analogous to the binding object in the
 <a href="../../../../de/elo/ix/jscript/DBConnection.html#query-java.lang.String-java.lang.Object-int-java.lang.Object-"><code>query(String, Object, int, Object)</code></a> function. Here is an example:<br>
 
 <pre>
 <code class="example">
 function Binding() {
   this.bindParam = function(row, col, obj) {
     switch (col) {
       case 1: return row.setString(col, obj);
       case 2: return row.setDouble(col, obj);
       case 3: return row.setInteger(col, obj);
       case 4: return row.setBytes(col, obj);
       default: throw "Invalid column";
     }
   }
 }
 
  function dbinsert() {
    var db = new Packages.de.elo.ix.jscript.DBConnection( "jdbc/MyDB2", "TESTSCHEMA" );
    var photos = [ ... bytes ... , ... bytes ... ]; 
    var args = [["Fritz", 54321.22, 38, photos[0]],["Maria", 65432.11, 43, photos[1]]];
    var ret = db.update("insert into employees (name, salary, age, passportphoto) values (?, ?, ?, ?)", args, new Binding());
    log.info("number of inserted rows=" + ret); // == 2
    return ret;
 }
 </code>
 </pre>
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SQL command.</dd>
<dd><code>rows</code> - Optional. Data to be written or parameters if the sqlcmd contains placeholders.</dd>
<dd><code>binding</code> - Optional. This parameter can hold a JavaScript object that passes the data of a
          selected column into a PreparedStatement object.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of modified rows.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../de/elo/ix/jscript/DBConnection.PreparedStatementWrapper.html" title="class in de.elo.ix.jscript"><code>DBConnection.PreparedStatementWrapper</code></a></dd>
</dl>
</li>
</ul>
<a name="update-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre>public&nbsp;java.lang.Integer&nbsp;update(java.lang.String&nbsp;sqlcmd)
                         throws java.sql.SQLException</pre>
<div class="block">Executes an update, delete or insert command.
 This function calls <a href="../../../../de/elo/ix/jscript/DBConnection.html#update-java.lang.String-java.lang.Object-java.lang.Object-"><code>update(String, Object, Object)</code></a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SQL command.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of modified rows.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="update-java.lang.String-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre>public&nbsp;java.lang.Integer&nbsp;update(java.lang.String&nbsp;sqlcmd,
                                java.lang.Object&nbsp;rows)
                         throws java.sql.SQLException</pre>
<div class="block">Executes an update, delete or insert command.
 This function calls <a href="../../../../de/elo/ix/jscript/DBConnection.html#update-java.lang.String-java.lang.Object-java.lang.Object-"><code>update(String, Object, Object)</code></a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SQL command.</dd>
<dd><code>rows</code> - see <a href="../../../../de/elo/ix/jscript/DBConnection.html#update-java.lang.String-java.lang.Object-java.lang.Object-"><code>update(String, Object, Object)</code></a></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of modified rows.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="escapeString-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>escapeString</h4>
<pre>public&nbsp;java.lang.String&nbsp;escapeString(java.lang.String&nbsp;value)</pre>
<div class="block">Return an escaped String value to be used in a SQL statement.
 Places an apostrophe before and after the given String and replaces every apostrophe in the string with two apostrophes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>value</code> - String value to be escaped.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Escaped String value.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../de/elo/ix/jscript/Convert.html" title="class in de.elo.ix.jscript"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../de/elo/ix/jscript/DBConnection.PreparedStatementWrapper.html" title="class in de.elo.ix.jscript"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?de/elo/ix/jscript/DBConnection.html" target="_top">Frames</a></li>
<li><a href="DBConnection.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><i>Copyright &#169; ELO Digital Office GmbH. All Rights Reserved.</i></small></p>
</body>
</html>
